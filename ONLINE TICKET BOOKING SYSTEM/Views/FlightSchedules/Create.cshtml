@model ONLINE_TICKET_BOOKING_SYSTEM.Models.Air.FlightSchedule
@{
    ViewData["Title"] = "Create Flight Schedule";
    Layout = "~/Views/Shared/_AdminLayout.cshtml";
}
<h3>Create Flight Schedule</h3>
<hr />

<form id="form" asp-action="Create" method="post">
    @Html.AntiForgeryToken()
    <div asp-validation-summary="ModelOnly" class="text-danger"></div>

    <div class="row g-3">
        <div class="col-md-4">
            <label class="form-label">Airline</label>
            <select asp-for="AirlineId" class="form-select" asp-items="ViewBag.AirlineId"></select>
            <span asp-validation-for="AirlineId" class="text-danger"></span>
        </div>
        <div class="col-md-4">
            <label class="form-label">From</label>
            <select asp-for="FromAirportId" class="form-select" asp-items="ViewBag.FromAirportId"></select>
            <span asp-validation-for="FromAirportId" class="text-danger"></span>
        </div>
        <div class="col-md-4">
            <label class="form-label">To</label>
            <select asp-for="ToAirportId" class="form-select" asp-items="ViewBag.ToAirportId"></select>
            <span asp-validation-for="ToAirportId" class="text-danger"></span>
        </div>

        <div class="col-md-3">
            <label class="form-label">Flight Number</label>
            <input asp-for="FlightNumber" class="form-control" />
            <span asp-validation-for="FlightNumber" class="text-danger"></span>
        </div>
        <div class="col-md-3">
            <label class="form-label">Dep Time (local)</label>
            <input asp-for="DepTimeLocal" type="time" class="form-control" />
            <span asp-validation-for="DepTimeLocal" class="text-danger"></span>
        </div>
        <div class="col-md-3">
            <label class="form-label">Arr Time (local)</label>
            <input asp-for="ArrTimeLocal" type="time" class="form-control" />
            <span asp-validation-for="ArrTimeLocal" class="text-danger"></span>
        </div>
        <div class="col-md-3">
            <label class="form-label">Duration (min)</label>
            <input asp-for="DurationMinutes" type="number" min="0" class="form-control" />
            <span asp-validation-for="DurationMinutes" class="text-danger"></span>
        </div>

        <div class="col-md-3">
            <label class="form-label">Operating Days Mask</label>
            <input asp-for="OperatingDaysMask" type="number" min="0" max="127" class="form-control" />
            <span asp-validation-for="OperatingDaysMask" class="text-danger"></span>
        </div>
        <div class="col-md-3">
            <label class="form-label">Equipment</label>
            <input asp-for="Equipment" class="form-control" />
            <span asp-validation-for="Equipment" class="text-danger"></span>
        </div>
    </div>

    <div class="mt-3">
        <button class="btn btn-success" type="submit">Save</button>
        <a class="btn btn-secondary" asp-action="Index">Back</a>
    </div>
</form>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script>
        (function(){
          var $form = $("#form");
          $form.on("submit", function(e){
            e.preventDefault();
            Swal.fire({title:"Saving...", allowOutsideClick:false, didOpen:()=>Swal.showLoading()});
            $.ajax({
              url: $form.attr("action"),
              type: "POST",
              data: $form.serialize(),
              headers: {"X-Requested-With":"XMLHttpRequest"}
            })
            .done(res => {
              if(res && res.ok){ Swal.fire({icon:'success', title:'Saved'}).then(()=>location=res.redirect); }
              else { Swal.fire({icon:'error', title:'Failed', text:'Unexpected response'}); }
            })
            .fail(xhr => {
              let msg = xhr.responseText || xhr.statusText || "Error";
              Swal.fire({icon:'error', title:'Failed', text:msg});
            });
          });
        })();
    </script>
}
