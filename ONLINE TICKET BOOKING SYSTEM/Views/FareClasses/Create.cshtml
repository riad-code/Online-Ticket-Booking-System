@model ONLINE_TICKET_BOOKING_SYSTEM.Models.Air.FareClass
@{
    ViewData["Title"] = "Create Fare Class";
    Layout = "~/Views/Shared/_AdminLayout.cshtml";
}
<h3>Create Fare Class</h3>
<hr />
<form id="form" method="post" action="/FareClasses/Create">
    @Html.AntiForgeryToken()
    <div asp-validation-summary="ModelOnly" class="text-danger"></div>

    <div class="row g-3">
        <div class="col-md-6">
            <label class="form-label">Flight</label>
            <select asp-for="FlightScheduleId" class="form-select" asp-items="ViewBag.FlightScheduleId"></select>
            <span asp-validation-for="FlightScheduleId" class="text-danger"></span>
        </div>
        <div class="col-md-3">
            <label class="form-label">Cabin</label>
            <select asp-for="Cabin" class="form-select" asp-items="ViewBag.Cabins"></select>
            <span asp-validation-for="Cabin" class="text-danger"></span>
        </div>
        <div class="col-md-3">
            <label class="form-label">RBD</label>
            <input asp-for="Rbd" class="form-control" />
            <span asp-validation-for="Rbd" class="text-danger"></span>
        </div>
        <div class="col-md-2">
            <label class="form-label">Seats</label>
            <input asp-for="SeatsAvailable" class="form-control" />
            <span asp-validation-for="SeatsAvailable" class="text-danger"></span>
        </div>
        <div class="col-md-3">
            <label class="form-label">Base Fare</label>
            <input asp-for="BaseFare" class="form-control" />
            <span asp-validation-for="BaseFare" class="text-danger"></span>
        </div>
        <div class="col-md-3">
            <label class="form-label">Taxes & Fees</label>
            <input asp-for="TaxesAndFees" class="form-control" />
            <span asp-validation-for="TaxesAndFees" class="text-danger"></span>
        </div>
        <div class="col-md-2">
            <label class="form-label">Currency</label>
            <input asp-for="Currency" class="form-control" />
            <span asp-validation-for="Currency" class="text-danger"></span>
        </div>
        <div class="col-md-4">
            <label class="form-label">Baggage</label>
            <input asp-for="Baggage" class="form-control" />
            <span asp-validation-for="Baggage" class="text-danger"></span>
        </div>
        <div class="col-md-2">
            <label class="form-label d-block">Refundable</label>
            <input asp-for="Refundable" type="checkbox" class="form-check-input" />
            <span asp-validation-for="Refundable" class="text-danger"></span>
        </div>
    </div>

    <div class="mt-3">
        <button class="btn btn-success" type="submit">Save</button>
        <a class="btn btn-secondary" href="/FareClasses/Index">Back</a>
    </div>
</form>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script>
    (function(){
      const $form=$("#form");
      $form.on("submit", function(e){
        e.preventDefault();
        Swal.fire({title:"Saving...",allowOutsideClick:false,didOpen:()=>Swal.showLoading()});
        $.ajax({
          url:$form.attr("action"),
          type:"POST",
          data:$form.serialize(),
          headers:{"X-Requested-With":"XMLHttpRequest"}
        })
        .done(res=>{
          if(res && res.ok){ Swal.fire({icon:"success",title:"Saved"}).then(()=>location=res.redirect||"/FareClasses/Index"); }
          else{ Swal.fire({icon:"success",title:"Saved"}).then(()=>location="/FareClasses/Index"); }
        })
        .fail(xhr=>{
          let msg="Validation error";
          try{const r=JSON.parse(xhr.responseText); if(r.errors){const k=Object.keys(r.errors)[0]; const n=r.errors[k]; if(n.errors?.length) msg=n.errors[0].errorMessage;}}catch{}
          Swal.fire({icon:"error",title:"Failed",text:msg});
        });
      });
    })();
</script>
